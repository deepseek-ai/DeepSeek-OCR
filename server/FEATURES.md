# DeepSeek-OCR Web 服务 - 新增功能

## 🎨 新增下载功能

### 1. 下载提取的图片 (ZIP)
- **功能**: 将文档中提取的所有图片和图表打包为 ZIP 文件
- **格式**: `images_{job_id}.zip`
- **内容**: 
  - `images/0_0.jpg` - 第 0 页的第 0 张图片
  - `images/1_0.jpg` - 第 1 页的第 0 张图片
  - 依此类推...
- **用途**: 快速获取文档中的所有视觉元素（图表、示意图、照片等）

### 2. 下载全部文件 (ZIP)
- **功能**: 一键下载所有识别结果
- **格式**: `ocr_results_{job_id}.zip`
- **内容**:
  - `.mmd` - Markdown 文件
  - `_det.mmd` - 完整标注文件
  - `_layouts.pdf` - 可视化 PDF
  - `images/` - 所有提取的图片
- **用途**: 完整归档，方便分享和备份

## 📦 下载选项对比

| 下载选项 | 文件类型 | 大小 | 适用场景 |
|---------|---------|------|---------|
| 📝 Markdown | `.mmd` | 小 | 只需要文本内容 |
| 📋 完整标注 | `_det.mmd` | 中 | 需要查看检测标记 |
| 🖼️ 可视化 PDF | `_layouts.pdf` | 大 | 需要带框可视化 |
| 🎨 提取图片 | `images.zip` | 中 | **只需要图片和图表** |
| 📦 全部文件 | `all.zip` | 最大 | **完整备份和归档** |

## 🔧 技术实现

### 图片提取
- DeepSeek-OCR 会自动识别文档中的图像区域
- 使用边界框坐标裁剪原始图片
- 保存为高质量 JPEG 格式
- 按页码和序号命名（如 `3_0.jpg` 表示第3页第0张图）

### ZIP 打包
- 使用内存流创建 ZIP 文件，避免磁盘 I/O
- `zipfile.ZIP_DEFLATED` 压缩算法，平衡速度和压缩率
- 保持目录结构，便于解压后使用

### API 端点

```python
GET /download/{job_id}/images
# 返回: images_{job_id}.zip

GET /download/{job_id}/all
# 返回: ocr_results_{job_id}.zip
```

## 📊 实际示例

### 示例 1: 学术论文
```
ocr_results_921392b0.zip
├── paper_det.mmd (55 KB)
├── paper.mmd (48 KB)
├── paper_layouts.pdf (7.3 MB)
└── images/
    ├── 2_0.jpg (52 KB) - 流程图
    ├── 3_0.jpg (24 KB) - 实验结果
    ├── 4_0.jpg (24 KB) - 对比表
    ├── 5_0.jpg (23 KB) - 架构图
    └── ... (共 14 张图片)
```

### 示例 2: 技术文档
- 提取所有截图和示意图
- 可直接用于演示或引用
- 保持原始分辨率和清晰度

## 🎯 使用建议

1. **学术研究**: 下载全部文件，保留完整引用信息
2. **快速浏览**: 只下载 Markdown，快速阅读文本
3. **制作 PPT**: 下载图片 ZIP，复用文档中的图表
4. **质量检查**: 下载可视化 PDF，核对检测框位置
5. **长期归档**: 下载全部文件，完整保存处理结果

## 🌟 界面优化

- **渐变按钮**: "下载全部文件" 使用紫色渐变，突出重要性
- **图标提示**: 每个下载选项都有对应的 emoji 图标
- **悬停效果**: 鼠标悬停时按钮上浮，提升交互体验
- **自动显示**: 处理完成后自动展示所有下载链接

## 🔄 更新日志

**v1.1 - 2025-10-22**
- ✅ 新增图片打包下载功能
- ✅ 新增全部文件打包下载功能
- ✅ 优化界面样式，突出重要下载选项
- ✅ 改进 ZIP 文件命名，包含 job_id

---

**服务地址**: http://<your-server-ip>:8000

